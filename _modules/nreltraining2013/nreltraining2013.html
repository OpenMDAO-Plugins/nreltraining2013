<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>nreltraining2013.nreltraining2013 &mdash; nreltraining2013 1.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="nreltraining2013 1.5 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">nreltraining2013 1.5 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for nreltraining2013.nreltraining2013</h1><div class="highlight"><pre>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ActuatorDisk&#39;</span><span class="p">,</span> <span class="s">&#39;BEM&#39;</span><span class="p">,</span> <span class="s">&#39;AutoBEM&#39;</span><span class="p">,</span> <span class="s">&#39;BladeElement&#39;</span><span class="p">,</span> <span class="s">&#39;BEMPerf&#39;</span><span class="p">,</span> <span class="s">&#39;BEMPerfData&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">from</span> <span class="nn">openmdao.main.api</span> <span class="kn">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Assembly</span><span class="p">,</span> <span class="n">VariableTree</span>
<span class="kn">from</span> <span class="nn">openmdao.lib.datatypes.api</span> <span class="kn">import</span> <span class="n">Float</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Array</span><span class="p">,</span> <span class="n">VarTree</span>
<span class="kn">from</span> <span class="nn">openmdao.lib.components.api</span> <span class="kn">import</span> <span class="n">LinearDistribution</span>


<div class="viewcode-block" id="ActuatorDisk"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.ActuatorDisk">[docs]</a><span class="k">class</span> <span class="nc">ActuatorDisk</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple wind turbine model based on actuator disk theory&quot;&quot;&quot;</span>

    <span class="c"># inputs</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Induced Velocity Factor&quot;</span><span class="p">)</span>
    <span class="n">Area</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Rotor disk area&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m**2&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.225</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;air density&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;kg/m**3&quot;</span><span class="p">)</span>
    <span class="n">Vu</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Freestream air velocity, upstream of rotor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>

    <span class="c"># outputs</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Air velocity at rotor exit plane&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">Vd</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Slipstream air velocity, dowstream of rotor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">Ct</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Thrust Coefficient&quot;</span><span class="p">)</span>
    <span class="n">thrust</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Thrust produced by the rotor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;N&quot;</span><span class="p">)</span>
    <span class="n">Cp</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Power Coefficient&quot;</span><span class="p">)</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Power produced by the rotor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;W&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ActuatorDisk.execute"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.ActuatorDisk.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># we use &#39;a&#39; and &#39;V0&#39; a lot, so make method local variables</span>

        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">Vu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vu</span>

        <span class="n">qA</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Area</span><span class="o">*</span><span class="n">Vu</span><span class="o">**</span><span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Vd</span> <span class="o">=</span> <span class="n">Vu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vr</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Vu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vd</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ct</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thrust</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ct</span><span class="o">*</span><span class="n">qA</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ct</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp</span><span class="o">*</span><span class="n">qA</span><span class="o">*</span><span class="n">Vu</span>

</div></div>
<span class="k">class</span> <span class="nc">FlowConditions</span><span class="p">(</span><span class="n">VariableTree</span><span class="p">):</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.225</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;air density&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;kg/m**3&quot;</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">7.</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;free stream air velocity&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="BEMPerfData"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BEMPerfData">[docs]</a><span class="k">class</span> <span class="nc">BEMPerfData</span><span class="p">(</span><span class="n">VariableTree</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Container that holds all rotor performance data&quot;&quot;&quot;</span>

    <span class="n">net_thrust</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;net axial thrust&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;N&quot;</span><span class="p">)</span>
    <span class="n">net_power</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;net power produced&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;W&quot;</span><span class="p">)</span>
    <span class="n">Ct</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;thrust coefficient&quot;</span><span class="p">)</span>
    <span class="n">Cp</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;power coefficient&quot;</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;advance ratio&quot;</span><span class="p">)</span>
    <span class="n">tip_speed_ratio</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;tip speed ratio&quot;</span><span class="p">)</span>
    <span class="c">#eta = Float(desc=&quot;turbine efficiency&quot;)</span>

</div>
<div class="viewcode-block" id="BEMPerf"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BEMPerf">[docs]</a><span class="k">class</span> <span class="nc">BEMPerf</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;collects data from set of BladeElements and calculates aggregate values&quot;&quot;&quot;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;tip radius of the rotor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">rpm</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">2100</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;rotations per minute&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;min**-1&quot;</span><span class="p">)</span>

    <span class="n">free_stream</span> <span class="o">=</span> <span class="n">VarTree</span><span class="p">(</span><span class="n">FlowConditions</span><span class="p">(),</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">VarTree</span><span class="p">(</span><span class="n">BEMPerfData</span><span class="p">(),</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">)</span>

    <span class="c"># this lets the size of the arrays vary for different numbers of elements</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BEMPerf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="c"># needed initialization for VTs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="n">BEMPerfData</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;free_stream&#39;</span><span class="p">,</span> <span class="n">FlowConditions</span><span class="p">())</span>

        <span class="c"># array size based on number of elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;delta_Ct&#39;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&#39;in&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&#39;thrusts from </span><span class="si">%d</span><span class="s"> different blade elements&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">,</span>
                               <span class="n">default_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;N&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;delta_Cp&#39;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&#39;in&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&#39;Cp integrant points from </span><span class="si">%d</span><span class="s"> different blade elements&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">,</span>
                               <span class="n">default_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;lambda_r&#39;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&#39;in&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&#39;lambda_r from </span><span class="si">%d</span><span class="s"> different blade elements&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">,</span>
                               <span class="n">default_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Float</span><span class="p">))</span>

<div class="viewcode-block" id="BEMPerf.execute"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BEMPerf.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">BEMPerfData</span><span class="p">()</span>  <span class="c"># empty the variable tree</span>

        <span class="n">V_inf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_stream</span><span class="o">.</span><span class="n">V</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_stream</span><span class="o">.</span><span class="n">rho</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">V_inf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_Ct</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">net_thrust</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Ct</span><span class="o">*</span><span class="n">norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_Cp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">net_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Cp</span><span class="o">*</span><span class="n">norm</span><span class="o">*</span><span class="n">V_inf</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">V_inf</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpm</span><span class="o">/</span><span class="mf">60.0</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>

        <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpm</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">60</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tip_speed_ratio</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">free_stream</span><span class="o">.</span><span class="n">V</span>

</div></div>
<div class="viewcode-block" id="BEM"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BEM">[docs]</a><span class="k">class</span> <span class="nc">BEM</span><span class="p">(</span><span class="n">Assembly</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Blade Rotor with 3 BladeElements&quot;&quot;&quot;</span>

    <span class="c"># physical properties inputs</span>
    <span class="n">r_hub</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;blade hub radius&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">twist_hub</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;twist angle at the hub radius&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">chord_hub</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;chord length at the rotor hub&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>
    <span class="n">r_tip</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;blade tip radius&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">twist_tip</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">-</span><span class="mf">3.58</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;twist angle at the tip radius&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">chord_tip</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">.</span><span class="mi">187</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;chord length at the rotor hub&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=.</span><span class="mo">05</span><span class="p">)</span>
    <span class="n">pitch</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;overall blade pitch&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">rpm</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">107</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;rotations per minute&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;min**-1&quot;</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;number of blades&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c"># wind condition inputs</span>
    <span class="n">free_stream</span> <span class="o">=</span> <span class="n">VarTree</span><span class="p">(</span><span class="n">FlowConditions</span><span class="p">(),</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BEM</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;free_stream&#39;</span><span class="p">,</span> <span class="n">FlowConditions</span><span class="p">())</span>

<div class="viewcode-block" id="BEM.configure"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BEM.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;BE0&#39;</span><span class="p">,</span> <span class="n">BladeElement</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;BE1&#39;</span><span class="p">,</span> <span class="n">BladeElement</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;BE2&#39;</span><span class="p">,</span> <span class="n">BladeElement</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;perf&#39;</span><span class="p">,</span> <span class="n">BEMPerf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE0.delta_Ct&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Ct[0]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE0.delta_Cp&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Cp[0]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE0.lambda_r&#39;</span><span class="p">,</span> <span class="s">&#39;perf.lambda_r[0]&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE1.delta_Ct&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Ct[1]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE1.delta_Cp&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Cp[1]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE1.lambda_r&#39;</span><span class="p">,</span> <span class="s">&#39;perf.lambda_r[1]&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE2.delta_Ct&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Ct[2]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE2.delta_Cp&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Cp[2]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;BE2.lambda_r&#39;</span><span class="p">,</span> <span class="s">&#39;perf.lambda_r[2]&#39;</span><span class="p">)</span>

        <span class="c">#self.connect(&#39;free_stream.rho&#39;, &#39;BE0.rho&#39;)</span>
        <span class="c">#self.connect(&#39;free_stream.rho&#39;, &#39;BE1.rho&#39;)</span>
        <span class="c">#self.connect(&#39;free_stream.rho&#39;, &#39;BE2.rho&#39;)</span>
        <span class="c">#self.connect(&#39;free_stream&#39;, &#39;perf.free_stream&#39;)</span>

        <span class="c">#self.driver.workflow.add([&#39;BE0&#39;, &#39;BE1&#39;, &#39;BE2&#39;, &#39;perf&#39;])</span>

</div></div>
<div class="viewcode-block" id="AutoBEM"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.AutoBEM">[docs]</a><span class="k">class</span> <span class="nc">AutoBEM</span><span class="p">(</span><span class="n">BEM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Blade Rotor with user specified number BladeElements&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_elements</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_elements</span> <span class="o">=</span> <span class="n">n_elements</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoBEM</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="AutoBEM.configure"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.AutoBEM.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;free_stream&#39;</span><span class="p">,</span> <span class="n">FlowConditions</span><span class="p">())</span>  <span class="c"># initialize</span>

        <span class="n">n_elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_elements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;radius_dist&#39;</span><span class="p">,</span> <span class="n">LinearDistribution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_elements</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;r_hub&#39;</span><span class="p">,</span> <span class="s">&#39;radius_dist.start&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;r_tip&#39;</span><span class="p">,</span> <span class="s">&#39;radius_dist.end&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;chord_dist&#39;</span><span class="p">,</span> <span class="n">LinearDistribution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_elements</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;chord_hub&#39;</span><span class="p">,</span> <span class="s">&#39;chord_dist.start&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;chord_tip&#39;</span><span class="p">,</span> <span class="s">&#39;chord_dist.end&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;twist_dist&#39;</span><span class="p">,</span> <span class="n">LinearDistribution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_elements</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;deg&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;twist_hub&#39;</span><span class="p">,</span> <span class="s">&#39;twist_dist.start&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;twist_tip&#39;</span><span class="p">,</span> <span class="s">&#39;twist_dist.end&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;pitch&#39;</span><span class="p">,</span> <span class="s">&#39;twist_dist.offset&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;chord_dist&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;radius_dist&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;twist_dist&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;perf&#39;</span><span class="p">,</span> <span class="n">BEMPerf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_elements</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_passthrough</span><span class="p">(</span><span class="s">&#39;perf.data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;r_tip&#39;</span><span class="p">,</span> <span class="s">&#39;perf.r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;rpm&#39;</span><span class="p">,</span> <span class="s">&#39;perf.rpm&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;free_stream&#39;</span><span class="p">,</span> <span class="s">&#39;perf.free_stream&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_elements</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;BE</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">BladeElement</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;radius_dist.output[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.r&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;radius_dist.delta&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.dr&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;twist_dist.output[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.twist&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;chord_dist.output[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&quot;.chord&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.B&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;rpm&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.rpm&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;free_stream.rho&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.rho&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;free_stream.V&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">+</span><span class="s">&#39;.V_inf&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;.delta_Ct&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Ct[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;.delta_Cp&#39;</span><span class="p">,</span> <span class="s">&#39;perf.delta_Cp[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;.lambda_r&#39;</span><span class="p">,</span> <span class="s">&#39;perf.lambda_r[</span><span class="si">%d</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;perf&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="BladeElement"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BladeElement">[docs]</a><span class="k">class</span> <span class="nc">BladeElement</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculations for a single radial slice of a rotor blade&quot;&quot;&quot;</span>

    <span class="c"># inputs</span>
    <span class="n">a_init</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;initial guess for axial inflow factor&quot;</span><span class="p">)</span>
    <span class="n">b_init</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;initial guess for angular inflow factor&quot;</span><span class="p">)</span>
    <span class="n">rpm</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">106.952</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;rotations per minute&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;min**-1&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;mean radius of the blade element&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;width of the blade element&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">twist</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.616</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;local twist angle&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;rad&quot;</span><span class="p">)</span>
    <span class="n">chord</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">.</span><span class="mi">1872796</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;local chord length&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Number of blade elements&quot;</span><span class="p">)</span>

    <span class="n">rho</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.225</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;air density&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;kg/m**3&quot;</span><span class="p">)</span>
    <span class="n">V_inf</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;in&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;free stream air velocity&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>

    <span class="c"># outputs</span>
    <span class="n">V_0</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;axial flow at propeller disk&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">V_1</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;local flow velocity&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">V_2</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;angular flow at propeller disk&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;average angular velocity for element&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;rad/s&quot;</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;Local solidity&quot;</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;local angle of attack&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;rad&quot;</span><span class="p">)</span>
    <span class="n">delta_Ct</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;section thrust coefficient&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;N&quot;</span><span class="p">)</span>
    <span class="n">delta_Cp</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;section power coefficent&quot;</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;converged value for axial inflow factor&quot;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;converged value for radial inflow factor&quot;</span><span class="p">)</span>
    <span class="n">lambda_r</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;local tip speed ratio&quot;</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.487</span><span class="p">,</span> <span class="n">iotype</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;relative flow angle onto blades&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;rad&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BladeElement</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="c"># rough linear interpolation from naca 0012 airfoil data</span>
        <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">13.</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cl_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cd_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_coeff_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="n">C_L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cl_interp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">C_D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cd_interp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">C_D</span><span class="p">,</span> <span class="n">C_L</span>

<div class="viewcode-block" id="BladeElement.execute"><a class="viewcode-back" href="../../srcdocs.html#nreltraining2013.nreltraining2013.BladeElement.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">chord</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpm</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">60.0</span>
        <span class="n">omega_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">V_inf</span>  <span class="c"># need lambda_r for iterates</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iteration</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">a_init</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_init</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">V_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_inf</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">V_inf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_2</span> <span class="o">=</span> <span class="n">omega_r</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">omega_r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">V_0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">V_2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**.</span><span class="mi">5</span>

        <span class="n">q_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="o">*.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">V_1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">chord</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dr</span>
        <span class="n">cos_phi</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">sin_phi</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">C_D</span><span class="p">,</span> <span class="n">C_L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeff_lookup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_Ct</span> <span class="o">=</span> <span class="n">q_c</span><span class="o">*</span><span class="p">(</span><span class="n">C_L</span><span class="o">*</span><span class="n">cos_phi</span><span class="o">-</span><span class="n">C_D</span><span class="o">*</span><span class="n">sin_phi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">V_inf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_Cp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">C_D</span><span class="o">/</span><span class="n">C_L</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">twist</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span>
        <span class="n">C_D</span><span class="p">,</span> <span class="n">C_L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coeff_lookup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">*</span><span class="n">C_L</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">*</span><span class="n">C_L</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">top</span> <span class="o">=</span> <span class="n">Assembly</span><span class="p">()</span>
    <span class="n">top</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">AutoBEM</span><span class="p">())</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">)</span>

    <span class="c">#top.run()</span>

    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">rpm</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Cp</span>
    <span class="k">print</span> <span class="s">&#39;top.b.chord_hub: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">chord_hub</span>
    <span class="k">print</span> <span class="s">&#39;top.b.chord_tip: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">chord_tip</span>
    <span class="k">print</span> <span class="s">&#39;lambda: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tip_speed_ratio</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">chord</span>

    <span class="kn">from</span> <span class="nn">openmdao.lib.drivers.api</span> <span class="kn">import</span> <span class="n">SLSQPdriver</span>
    <span class="n">top</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;driver&#39;</span><span class="p">,</span> <span class="n">SLSQPdriver</span><span class="p">())</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.chord_hub&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.chord_tip&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.twist_hub&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.twist_tip&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.rpm&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;b.r_tip&#39;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">top</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;-b.data.Cp&#39;</span><span class="p">)</span>

    <span class="n">top</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">print</span>
    <span class="k">print</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">rpm</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Cp</span>
    <span class="k">print</span> <span class="s">&#39;top.b.chord_hub: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">chord_hub</span>
    <span class="k">print</span> <span class="s">&#39;top.b.chord_tip: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">chord_tip</span>
    <span class="k">print</span> <span class="s">&#39;lambda: &#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tip_speed_ratio</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE0</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE1</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE2</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE3</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE4</span><span class="o">.</span><span class="n">chord</span>
    <span class="k">print</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">BE5</span><span class="o">.</span><span class="n">chord</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">nreltraining2013 1.5 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright .
      Last updated on Mar 20, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>